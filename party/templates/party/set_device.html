<!DOCTYPE html>

{% extends "base.html" %}
{% block page_content %}

	<style>
		.device{
			color:gray;
			font-size: 30px;
		}
	</style>
	<script>
		$(document).ready(function() {
			setActiveProperties('{{device.active}}'=='True','{{device.type}}', '{{device.name}}');
		});

		var inactivity = false;

		setInterval(function () {
			if (!inactivity){
				$.ajax({
					url: '/party/update_set_device',
					data: {
					'pid': {{ party.pk }}
					},
					dataType: 'json',
					success: function (data) {
						setActiveProperties(data.device.active, data.device.type, data.device.name)
						inactivity = data.stop;
					}
				});
			}
		}, 1000);
	</script>

	<div class="container">				
		<form action="" method="post">
			{% csrf_token %}
			<div class = "pt-2">
				<div class = "pb-3">
					<h5><b>Set Playback Device in Spotify</b></h5>
				</div>
				<div id="message" class = "pl-3 pb-3">
					<h5>1. Open Spotify</h5>
					<h5>2. Shuffle Your Fav Playlist</h5>
					<h5>3. Click Continue Below</h5>
				</div>
				<div class = "card">
					<div class="pl-4 pt-2 pb-2 text-left row">
						<div class = "col-1 pr-0">
							<em id="device" class="device"></em>
						</div>
						<div id="name" class="col-11 text-left pl-5 pt-1">
							No Active Device Found
						</div>
					</div>
				</div>

				<div class="text-right pt-2">
					<input id="submit" type="submit" class="btn btn-outline-secondary" value="Continue" disabled></div>
				</div>
			</div>
		</form>
		
		<!-- Button to Open the Modal --
		<div class = "pt-5 text-right">
			<button type="button" class="btn btn-outline-info" data-toggle="modal" data-target="#myModal">
				Not Seeing Your Device?
			</button>
		</div>-->
	</div>
	

	<!-- The Modal -->
	<div class="modal fade" id="myModal">
		<div class="modal-dialog">
			<div class="modal-dialog modal-dialog-scrollable">
				<div class="modal-content">
					<!-- Modal Header -->
					<div class="modal-header">
					<h4 class="modal-title">Not Seeing your Device?</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					</div>
					<!-- Modal body -->
					<div class="modal-body">
						<p>Try opening the Spotify app.</p>
						<p>In order for your device to be recognized, Spotify needs to be open on your device.</p>
						<p>A device can be anything that is compatible with Spotify. It could be a phone, laptop, web-player, or a smart speaker</p>
					</div>
					<!-- Modal footer -->
					<div class="modal-footer">
						<button type="button" class="btn btn-outline-info" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
